<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Appointment Requests | MediTracker</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-[#F7FAFC] font-sans">
<div class="flex min-h-screen">

<!-- SIDEBAR -->
<aside class="w-64 bg-[#0E1626] text-white flex flex-col justify-between">
  <div>
    <div class="flex items-center gap-2 px-6 py-6 text-xl font-bold text-emerald-400">
      ğŸ’š MediTracker
    </div>

    <nav class="mt-6 space-y-1">
      <a href="{% url 'core:doctor_dashboard' %}"
         class="flex items-center gap-3 px-6 py-3 text-gray-300 hover:bg-[#111827]">
        ğŸ  Dashboard
      </a>

      <a href="{% url 'appointments:doctor_list' %}"
         class="flex items-center gap-3 px-6 py-3 rounded-r-full bg-[#3F8F6B]">
        ğŸ“… Appointments
      </a>
    </nav>
  </div>

  <!-- USER + LOGOUT -->
  <div class="px-6 py-6 border-t border-[#111827] space-y-4">
    <div>
      <p class="text-sm font-semibold">
        {{ request.user.get_full_name|default:request.user.username }}
      </p>
      <p class="text-xs text-gray-400">Doctor</p>
    </div>

    <a href="{% url 'accounts:logout' %}"
       class="block text-center bg-red-500 hover:bg-red-600
              text-white py-2 rounded-lg text-sm font-semibold transition">
      ğŸšª Logout
    </a>
  </div>
</aside>

<!-- MAIN -->
<main class="flex-1 p-10">

<h1 class="text-3xl font-bold text-[#0F172A]">
  Appointment Requests
</h1>
<p class="text-[#6B7280] mt-1 mb-8">
  Review and manage patient appointment requests
</p>

<!-- APPOINTMENT CARDS -->
<div class="bg-white rounded-[20px] shadow p-8 space-y-6">

{% if appointments %}

  {% for appt in appointments %}
  <div class="flex items-center justify-between border-b pb-6 last:border-none">

    <!-- LEFT SIDE (Patient Info) -->
     
    <div>
      <p class="text-lg font-semibold text-[#0F172A]">
        {{ appt.patient.get_full_name|default:appt.patient.username }}
      </p>

      <p class="text-sm text-[#6B7280]">
        {{ appt.appointment_date|date:"d M Y" }} â€¢
        {{ appt.appointment_time|time:"h:i A" }}
      </p>
      {% if appt.created_by_family %}
      <p class="text-xs text-blue-600 mt-1">
    ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Booked by family:
    {{ appt.created_by_family.get_full_name|default:appt.created_by_family.username }}
     </p>
      {% endif %}
      <!-- STATUS BADGE -->
      <div class="mt-2">
        {% if appt.status == "pending" %}
            <span class="px-3 py-1 text-xs rounded-full bg-gray-200 text-gray-700">
                Pending
            </span>

        {% elif appt.status == "approved" %}
            <span class="px-3 py-1 text-xs rounded-full bg-green-100 text-green-700">
                Approved
            </span>

        {% elif appt.status == "today" %}
            <span class="px-3 py-1 text-xs rounded-full bg-yellow-100 text-yellow-700">
                Today
            </span>

        {% else %}
            <span class="px-3 py-1 text-xs rounded-full bg-blue-100 text-blue-700">
                {{ appt.status|title }}
            </span>
        {% endif %}
      </div>
    </div>

    <!-- RIGHT SIDE (Review Button Only) -->
    <div>
      <a href="{% url 'appointments:doctor_review' appt.id %}"
         class="bg-[#5C8F70] hover:opacity-90 text-white px-6 py-2 rounded-xl font-semibold transition">
        Review
      </a>
    </div>

  </div>
  {% endfor %}

{% else %}
  <p class="text-gray-500">No appointment requests available.</p>
{% endif %}

</div>

</main>
</div>
</body>
</html>